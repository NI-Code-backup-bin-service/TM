--multiline
CREATE PROCEDURE `updateMpans`()
BEGIN
	# Temp table to store the data.
	DROP TEMPORARY TABLE IF EXISTS visa_qr_temp;
	CREATE TEMPORARY TABLE visa_qr_temp (merchantNo VARCHAR(12), siteId INT(11), siteProfileId INT(11), currentActiveModulesValue TEXT, mpan VARCHAR(16), categoryCode VARCHAR(255));

	SET @siteProfileTypeId = (SELECT profile_type_id FROM profile_type WHERE `name` = 'site');

	SET @merchantNoDataElementId = (SELECT data_element_id FROM data_element WHERE `name` = 'merchantNo');
	SET @visaQrDataGroupId = (SELECT data_group_id FROM data_group WHERE `name` = 'visaQr');
	SET @mpanDataElementId = (SELECT data_element_id FROM data_element WHERE `name` = 'mpan' AND data_group_id = @visaQrDataGroupId);

	# Insert what we've been given.
	INSERT INTO visa_qr_temp (merchantNo, siteId, siteProfileId)
	VALUES  ('200600002455',NULL,NULL),
			('200600002604',NULL,NULL),
			('200600002927',NULL,NULL),
			('200600004287',NULL,NULL),
			('200600005177',NULL,NULL),
			('200600006290',NULL,NULL),
			('200600006621',NULL,NULL),
			('200600007264',NULL,NULL),
			('200600007280',NULL,NULL),
			('200600007538',NULL,NULL),
			('200600008098',NULL,NULL),
			('200600010367',NULL,NULL),
			('200600011480',NULL,NULL),
			('200600012223',NULL,NULL),
			('200600012272',NULL,NULL),
			('200600012363',NULL,NULL),
			('200600012843',NULL,NULL),
			('200600013304',NULL,NULL),
			('200600014286',NULL,NULL),
			('200600014377',NULL,NULL),
			('200600014443',NULL,NULL),
			('200600014930',NULL,NULL),
			('200600014948',NULL,NULL),
			('200600015325',NULL,NULL),
			('200600015713',NULL,NULL),
			('200600015796',NULL,NULL),
			('200600015911',NULL,NULL),
			('200600016133',NULL,NULL),
			('200600016489',NULL,NULL),
			('200600017198',NULL,NULL),
			('200600017230',NULL,NULL),
			('200600017719',NULL,NULL),
			('200600017735',NULL,NULL),
			('200600017933',NULL,NULL),
			('200600018105',NULL,NULL),
			('200600018758',NULL,NULL),
			('200600018998',NULL,NULL),
			('200600020135',NULL,NULL),
			('200600020606',NULL,NULL),
			('200600021919',NULL,NULL),
			('200600022339',NULL,NULL),
			('200600022941',NULL,NULL),
			('200600023675',NULL,NULL),
			('200600023766',NULL,NULL),
			('200600023881',NULL,NULL),
			('200600024939',NULL,NULL),
			('200600025035',NULL,NULL),
			('200600026777',NULL,NULL),
			('200600026785',NULL,NULL),
			('200600027205',NULL,NULL),
			('200600027270',NULL,NULL),
			('200600027353',NULL,NULL),
			('200600027445',NULL,NULL),
			('200600027494',NULL,NULL),
			('200600027643',NULL,NULL),
			('200600027882',NULL,NULL),
			('200600028633',NULL,NULL),
			('200600028757',NULL,NULL),
			('200600029003',NULL,NULL),
			('200600029359',NULL,NULL),
			('200600029946',NULL,NULL),
			('200600029953',NULL,NULL),
			('200600031058',NULL,NULL),
			('200600031769',NULL,NULL),
			('200600031900',NULL,NULL),
			('200600031991',NULL,NULL),
			('200600032981',NULL,NULL),
			('200600033476',NULL,NULL),
			('200600033609',NULL,NULL),
			('200600033930',NULL,NULL),
			('200600034656',NULL,NULL),
			('200600034714',NULL,NULL),
			('200600034953',NULL,NULL),
			('200600035620',NULL,NULL),
			('200600036545',NULL,NULL),
			('200600036636',NULL,NULL),
			('200600036768',NULL,NULL),
			('200600037063',NULL,NULL),
			('200600037113',NULL,NULL),
			('200600037725',NULL,NULL),
			('200600037832',NULL,NULL),
			('200600037980',NULL,NULL),
			('200600038137',NULL,NULL),
			('200600038194',NULL,NULL),
			('200600038483',NULL,NULL),
			('200600038756',NULL,NULL),
			('200600039218',NULL,NULL),
			('200600039267',NULL,NULL),
			('200600039507',NULL,NULL),
			('200600039523',NULL,NULL),
			('200600039762',NULL,NULL),
			('200600039788',NULL,NULL),
			('200600040588',NULL,NULL),
			('200600041370',NULL,NULL),
			('200600041792',NULL,NULL),
			('200600042006',NULL,NULL),
			('200600042022',NULL,NULL),
			('200600042030',NULL,NULL),
			('200600042923',NULL,NULL),
			('200600043046',NULL,NULL),
			('200600049126',NULL,NULL),
			('200600051023',NULL,NULL),
			('200600051825',NULL,NULL),
			('200600051965',NULL,NULL),
			('200600052401',NULL,NULL),
			('200600052435',NULL,NULL),
			('200600052773',NULL,NULL),
			('200600053185',NULL,NULL),
			('200600053961',NULL,NULL),
			('200600054225',NULL,NULL),
			('200600054282',NULL,NULL),
			('200600054555',NULL,NULL),
			('200600055305',NULL,NULL),
			('200600055701',NULL,NULL),
			('200600055792',NULL,NULL),
			('200600055974',NULL,NULL),
			('200600056113',NULL,NULL),
			('200600056402',NULL,NULL),
			('200600056659',NULL,NULL),
			('200600056931',NULL,NULL),
			('200600057129',NULL,NULL),
			('200600057228',NULL,NULL),
			('200600057483',NULL,NULL),
			('200600057491',NULL,NULL),
			('200600057541',NULL,NULL),
			('200600057681',NULL,NULL),
			('200600058135',NULL,NULL),
			('200600058606',NULL,NULL),
			('200600058705',NULL,NULL),
			('200600059075',NULL,NULL),
			('200600059158',NULL,NULL),
			('200600059786',NULL,NULL),
			('200600060339',NULL,NULL),
			('200600060354',NULL,NULL),
			('200600060636',NULL,NULL),
			('200600060800',NULL,NULL),
			('200600060818',NULL,NULL),
			('200600060842',NULL,NULL),
			('200600061352',NULL,NULL),
			('200600061626',NULL,NULL),
			('200600061758',NULL,NULL),
			('200600062012',NULL,NULL),
			('200600062558',NULL,NULL),
			('200600062780',NULL,NULL),
			('200600063564',NULL,NULL),
			('200600063796',NULL,NULL),
			('200600064158',NULL,NULL),
			('200600065221',NULL,NULL),
			('200600065569',NULL,NULL),
			('200600065882',NULL,NULL),
			('200600066153',NULL,NULL),
			('200600066765',NULL,NULL),
			('200600066823',NULL,NULL),
			('200600066914',NULL,NULL),
			('200600067243',NULL,NULL),
			('200600067300',NULL,NULL),
			('200600067631',NULL,NULL),
			('200600067664',NULL,NULL),
			('200600067698',NULL,NULL),
			('200600067896',NULL,NULL),
			('200600068118',NULL,NULL),
			('200600068456',NULL,NULL),
			('200600068621',NULL,NULL),
			('200600069215',NULL,NULL),
			('200600069371',NULL,NULL),
			('200600069587',NULL,NULL),
			('200600069678',NULL,NULL),
			('200600069744',NULL,NULL),
			('200600069777',NULL,NULL),
			('200600069835',NULL,NULL),
			('200600069850',NULL,NULL),
			('200600069900',NULL,NULL),
			('200600070098',NULL,NULL),
			('200600070122',NULL,NULL),
			('200600070130',NULL,NULL),
			('200600070262',NULL,NULL),
			('200600070296',NULL,NULL),
			('200600070379',NULL,NULL),
			('200600070478',NULL,NULL),
			('200600070684',NULL,NULL),
			('200600070767',NULL,NULL),
			('200600070874',NULL,NULL),
			('200600070882',NULL,NULL),
			('200600070890',NULL,NULL),
			('200600070924',NULL,NULL),
			('200600070981',NULL,NULL),
			('200600071153',NULL,NULL),
			('200600071351',NULL,NULL),
			('200600071377',NULL,NULL),
			('200600071476',NULL,NULL),
			('200600071559',NULL,NULL),
			('200600071567',NULL,NULL),
			('200600071609',NULL,NULL),
			('200600071633',NULL,NULL),
			('200600071765',NULL,NULL),
			('200600071799',NULL,NULL),
			('200600071948',NULL,NULL),
			('200600071997',NULL,NULL),
			('200600072193',NULL,NULL),
			('200600072375',NULL,NULL),
			('200600072458',NULL,NULL),
			('200600072474',NULL,NULL),
			('200600072565',NULL,NULL),
			('200600072722',NULL,NULL),
			('200600072789',NULL,NULL),
			('200600072813',NULL,NULL),
			('200600072870',NULL,NULL),
			('200600072961',NULL,NULL),
			('200600073027',NULL,NULL),
			('200600073068',NULL,NULL),
			('200600073274',NULL,NULL),
			('200600073589',NULL,NULL),
			('200600073977',NULL,NULL),
			('200600074306',NULL,NULL),
			('200600074330',NULL,NULL),
			('200600074512',NULL,NULL),
			('200600074785',NULL,NULL),
			('200600074868',NULL,NULL),
			('200600074983',NULL,NULL),
			('200600075089',NULL,NULL),
			('200600075121',NULL,NULL),
			('200600075220',NULL,NULL),
			('200600075238',NULL,NULL),
			('200600075303',NULL,NULL),
			('200600075501',NULL,NULL),
			('200600075741',NULL,NULL),
			('200600075915',NULL,NULL),
			('200600076079',NULL,NULL),
			('200600076111',NULL,NULL),
			('200600076129',NULL,NULL),
			('200600076186',NULL,NULL),
			('200600076293',NULL,NULL),
			('200600076335',NULL,NULL),
			('200600076475',NULL,NULL),
			('200600076624',NULL,NULL),
			('200600076707',NULL,NULL),
			('200600076731',NULL,NULL),
			('200600076756',NULL,NULL),
			('200600076772',NULL,NULL),
			('200600076871',NULL,NULL),
			('200600076897',NULL,NULL),
			('200600076962',NULL,NULL),
			('200600077002',NULL,NULL),
			('200600077101',NULL,NULL),
			('200600077143',NULL,NULL),
			('200600077150',NULL,NULL),
			('200600077176',NULL,NULL),
			('200600077218',NULL,NULL),
			('200600077341',NULL,NULL),
			('200600077481',NULL,NULL),
			('200600077564',NULL,NULL),
			('200600077606',NULL,NULL),
			('200600077630',NULL,NULL),
			('200600077648',NULL,NULL),
			('200600077739',NULL,NULL),
			('200600077804',NULL,NULL),
			('200600077812',NULL,NULL),
			('200600077887',NULL,NULL),
			('200600077994',NULL,NULL),
			('200600078000',NULL,NULL),
			('200600078083',NULL,NULL),
			('200600078117',NULL,NULL),
			('200600078174',NULL,NULL),
			('200600078182',NULL,NULL),
			('200600078190',NULL,NULL),
			('200600078216',NULL,NULL),
			('200600078240',NULL,NULL),
			('200600078273',NULL,NULL),
			('200600078281',NULL,NULL),
			('200600078489',NULL,NULL),
			('200600078562',NULL,NULL),
			('200600078588',NULL,NULL),
			('200600078638',NULL,NULL),
			('200600078646',NULL,NULL),
			('200600078703',NULL,NULL),
			('200600078729',NULL,NULL),
			('200600078760',NULL,NULL),
			('200600078794',NULL,NULL),
			('200600078877',NULL,NULL),
			('200600078919',NULL,NULL),
			('200600078927',NULL,NULL),
			('200600078943',NULL,NULL),
			('200600079024',NULL,NULL),
			('200600079040',NULL,NULL),
			('200600079099',NULL,NULL),
			('200600079131',NULL,NULL),
			('200600079248',NULL,NULL),
			('200600079321',NULL,NULL),
			('200600079388',NULL,NULL),
			('200600079420',NULL,NULL),
			('200600079479',NULL,NULL),
			('200600079495',NULL,NULL),
			('200600079511',NULL,NULL),
			('200600079545',NULL,NULL),
			('200600079602',NULL,NULL),
			('200600079610',NULL,NULL),
			('200600079636',NULL,NULL),
			('200600079644',NULL,NULL),
			('200600079677',NULL,NULL),
			('200600079685',NULL,NULL),
			('200600079693',NULL,NULL),
			('200600079701',NULL,NULL),
			('200600079727',NULL,NULL),
			('200600079743',NULL,NULL),
			('200600079776',NULL,NULL),
			('200600079875',NULL,NULL),
			('200600080006',NULL,NULL),
			('200600080030',NULL,NULL),
			('200600080055',NULL,NULL),
			('200600080139',NULL,NULL),
			('200600080147',NULL,NULL),
			('200600080170',NULL,NULL),
			('200600080188',NULL,NULL),
			('200600080196',NULL,NULL),
			('200600080212',NULL,NULL),
			('200600080253',NULL,NULL),
			('200600080261',NULL,NULL),
			('200600080279',NULL,NULL),
			('200600080295',NULL,NULL),
			('200600080303',NULL,NULL),
			('200600080311',NULL,NULL),
			('200600080329',NULL,NULL),
			('200600080345',NULL,NULL),
			('200600080410',NULL,NULL),
			('200600080584', NULL, NULL),
			('200600080600', NULL, NULL),
			('200600080626', NULL, NULL),
			('200600080634', NULL, NULL),
			('200600080667', NULL, NULL),
			('200600080675', NULL, NULL),
			('200600080683', NULL, NULL),
			('200600080774', NULL, NULL),
			('200600080881', NULL, NULL),
			('200600080949', NULL, NULL),
			('200600080956', NULL, NULL),
			('200600080972', NULL, NULL),
			('200600080980', NULL, NULL),
			('200600081004', NULL, NULL),
			('200600081020', NULL, NULL),
			('200600081038', NULL, NULL),
			('200600081046', NULL, NULL),
			('200600081053', NULL, NULL),
			('200600081061', NULL, NULL),
			('200600081079', NULL, NULL),
			('200600081087', NULL, NULL),
			('200600081111', NULL, NULL),
			('200600081129', NULL, NULL),
			('200600081145', NULL, NULL),
			('200600081152', NULL, NULL),
			('200600081178', NULL, NULL),
			('200600081186', NULL, NULL),
			('200600081194', NULL, NULL),
			('200600081202', NULL, NULL),
			('200600081228', NULL, NULL),
			('200600081277', NULL, NULL),
			('200600081491', NULL, NULL),
			('200600081509', NULL, NULL),
			('200600081517', NULL, NULL),
			('200600081533', NULL, NULL),
			('200600081541', NULL, NULL),
			('200600081558', NULL, NULL),
			('200600081566', NULL, NULL),
			('200600081574', NULL, NULL),
			('200600081582', NULL, NULL),
			('200600081590', NULL, NULL),
			('200600081673', NULL, NULL),
			('200600081699', NULL, NULL),
			('200600081707', NULL, NULL),
			('200600081715', NULL, NULL),
			('200600081723', NULL, NULL),
			('200600081731', NULL, NULL),
			('200600081830', NULL, NULL),
			('200600081871', NULL, NULL),
			('200600081905', NULL, NULL),
			('200600081962', NULL, NULL),
			('200600081970', NULL, NULL),
			('200600081988', NULL, NULL),
			('200600081996', NULL, NULL),
			('200600082036', NULL, NULL),
			('200600082051', NULL, NULL),
			('200600082127', NULL, NULL),
			('200600082135', NULL, NULL),
			('200600082143', NULL, NULL),
			('200600082200', NULL, NULL),
			('200600082218', NULL, NULL),
			('200600082317', NULL, NULL),
			('200600082341', NULL, NULL),
			('200600082358', NULL, NULL),
			('200600082366', NULL, NULL),
			('200600082382', NULL, NULL),
			('200600082390', NULL, NULL),
			('200600082424', NULL, NULL),
			('200600082432', NULL, NULL),
			('200600082440', NULL, NULL),
			('200600082457', NULL, NULL),
			('200600082473', NULL, NULL),
			('200600082499', NULL, NULL),
			('200600082549', NULL, NULL),
			('200600082572', NULL, NULL),
			('200600082606', NULL, NULL),
			('200600082630', NULL, NULL),
			('200600082663', NULL, NULL),
			('200600082713', NULL, NULL),
			('200600082721', NULL, NULL),
			('200600082747', NULL, NULL),
			('200600082754', NULL, NULL),
			('200600082762', NULL, NULL),
			('200600082770', NULL, NULL),
			('200600082804', NULL, NULL),
			('200600082820', NULL, NULL),
			('200600082838', NULL, NULL),
			('200600082846', NULL, NULL),
			('200600082853', NULL, NULL),
			('200600082937', NULL, NULL),
			('200600082945', NULL, NULL),
			('200600082952', NULL, NULL),
			('200600082978', NULL, NULL),
			('200600083026', NULL, NULL),
			('200600083042', NULL, NULL),
			('200600083091', NULL, NULL),
			('200600083125', NULL, NULL),
			('200600083141', NULL, NULL),
			('200600083158', NULL, NULL),
			('200600083166', NULL, NULL),
			('200600083190', NULL, NULL),
			('200600083208', NULL, NULL),
			('200600083224', NULL, NULL),
			('200600083240', NULL, NULL),
			('200600083257', NULL, NULL),
			('200600083281', NULL, NULL),
			('200600083299', NULL, NULL),
			('200600083315', NULL, NULL),
			('200600083323', NULL, NULL),
			('200600083372', NULL, NULL),
			('200600083380', NULL, NULL),
			('200600083414', NULL, NULL),
			('200600083422', NULL, NULL),
			('200600083430', NULL, NULL),
			('200600083448', NULL, NULL),
			('200600083489', NULL, NULL),
			('200600083505', NULL, NULL),
			('200600083521', NULL, NULL),
			('200600083554', NULL, NULL),
			('200600083653', NULL, NULL),
			('200600083661', NULL, NULL),
			('200600083695', NULL, NULL),
			('200600083703', NULL, NULL),
			('200600083745', NULL, NULL),
			('200600083810', NULL, NULL),
			('200600083828', NULL, NULL),
			('200600083851', NULL, NULL),
			('200600083877', NULL, NULL),
			('200600083885', NULL, NULL),
			('200600083893', NULL, NULL),
			('200600083901', NULL, NULL),
			('200600083927', NULL, NULL),
			('200600083943', NULL, NULL),
			('200600083968', NULL, NULL),
			('200600083992', NULL, NULL),
			('200600084016', NULL, NULL),
			('200600084040', NULL, NULL),
			('200600084073', NULL, NULL),
			('200600084081', NULL, NULL),
			('200600084115', NULL, NULL),
			('200600084123', NULL, NULL),
			('200600084131', NULL, NULL),
			('200600084156', NULL, NULL),
			('200600084164', NULL, NULL),
			('200600084198', NULL, NULL),
			('200600084263', NULL, NULL),
			('200600084289', NULL, NULL),
			('200600084297', NULL, NULL),
			('200600084313', NULL, NULL),
			('200600084339', NULL, NULL),
			('200600084347', NULL, NULL),
			('200600084354', NULL, NULL),
			('200600084362', NULL, NULL),
			('200600084404', NULL, NULL),
			('200600084412', NULL, NULL),
			('200600084438', NULL, NULL),
			('200600084453', NULL, NULL),
			('200600084461', NULL, NULL),
			('200600084479', NULL, NULL),
			('200600084487', NULL, NULL),
			('200600084495', NULL, NULL),
			('200600084503', NULL, NULL),
			('200600084511', NULL, NULL),
			('200600084529', NULL, NULL),
			('200600084537', NULL, NULL),
			('200600084552', NULL, NULL),
			('200600084636', NULL, NULL),
			('200600084644', NULL, NULL),
			('200600084743', NULL, NULL),
			('200600084750', NULL, NULL),
			('200600084784', NULL, NULL),
			('200600084834', NULL, NULL),
			('200600084842', NULL, NULL),
			('200600084859', NULL, NULL),
			('200600084875', NULL, NULL),
			('200600084891', NULL, NULL),
			('200600084941', NULL, NULL),
			('200600084982', NULL, NULL),
			('200600085005', NULL, NULL),
			('200600085047', NULL, NULL),
			('200600085054', NULL, NULL),
			('200600085096', NULL, NULL),
			('200600085112', NULL, NULL),
			('200600085120', NULL, NULL),
			('200600085138', NULL, NULL),
			('200600085161', NULL, NULL),
			('200600085187', NULL, NULL),
			('200600085203', NULL, NULL),
			('200600085211', NULL, NULL),
			('200600085237', NULL, NULL),
			('200600085252', NULL, NULL),
			('200600085260', NULL, NULL),
			('200600085278', NULL, NULL),
			('200600085286', NULL, NULL),
			('200600085294', NULL, NULL),
			('200600085302', NULL, NULL),
			('200600085310', NULL, NULL),
			('200600085336', NULL, NULL),
			('200600085344', NULL, NULL),
			('200600085369', NULL, NULL),
			('200600085377', NULL, NULL),
			('200600085385', NULL, NULL),
			('200600085393', NULL, NULL),
			('200600085427', NULL, NULL),
			('200600085443', NULL, NULL),
			('200600085476', NULL, NULL),
			('200600085484', NULL, NULL),
			('200600085492', NULL, NULL),
			('200600085518', NULL, NULL),
			('200600085526', NULL, NULL),
			('200600085534', NULL, NULL),
			('200600085567', NULL, NULL),
			('200600085591', NULL, NULL),
			('200600085617', NULL, NULL),
			('200600085625', NULL, NULL),
			('200600085658', NULL, NULL),
			('200600085674', NULL, NULL),
			('200600085708', NULL, NULL),
			('200600085740', NULL, NULL),
			('200600085757', NULL, NULL),
			('200600085765', NULL, NULL),
			('200600085773', NULL, NULL),
			('200600085781', NULL, NULL),
			('200600085799', NULL, NULL),
			('200600085922', NULL, NULL),
			('200600085963', NULL, NULL),
			('200600086037', NULL, NULL),
			('200600086045', NULL, NULL),
			('200600086144', NULL, NULL),
			('200600086151', NULL, NULL),
			('200600086177', NULL, NULL),
			('200600086185', NULL, NULL),
			('200600086227', NULL, NULL),
			('200600086409', NULL, NULL),
			('200600086425', NULL, NULL),
			('200600086441', NULL, NULL),
			('200600086599', NULL, NULL),
			('200600086615', NULL, NULL),
			('200600086623', NULL, NULL),
			('200600086656', NULL, NULL),
			('200600086664', NULL, NULL),
			('200600086672', NULL, NULL),
			('200600086698', NULL, NULL),
			('200600086706', NULL, NULL),
			('200600086714', NULL, NULL),
			('200600086755', NULL, NULL),
			('200600086763', NULL, NULL),
			('200600086771', NULL, NULL),
			('200600086839', NULL, NULL),
			('200600086847', NULL, NULL),
			('200600086888', NULL, NULL),
			('200600086904', NULL, NULL),
			('200600086920', NULL, NULL),
			('200600086938', NULL, NULL),
			('200600086946', NULL, NULL),
			('200600086953', NULL, NULL),
			('200600086979', NULL, NULL),
			('200600086987', NULL, NULL),
			('200600087035', NULL, NULL),
			('200600087043', NULL, NULL),
			('200600087050', NULL, NULL),
			('200600087068', NULL, NULL),
			('200600087076', NULL, NULL),
			('200600087092', NULL, NULL),
			('200600087126', NULL, NULL),
			('200600087167', NULL, NULL),
			('200600087175', NULL, NULL),
			('200600087183', NULL, NULL),
			('200600087217', NULL, NULL),
			('200600087233', NULL, NULL),
			('200600087258', NULL, NULL),
			('200600087266', NULL, NULL),
			('200600087274', NULL, NULL),
			('200600087308', NULL, NULL),
			('200600087316', NULL, NULL),
			('200600087357', NULL, NULL),
			('200600087365', NULL, NULL),
			('200600087373', NULL, NULL),
			('200600087449', NULL, NULL),
			('200600087720', NULL, NULL),
			('200600087860', NULL, NULL),
			('200600087910', NULL, NULL),
			('200600087951', NULL, NULL),
			('200600087969', NULL, NULL),
			('200600087977', NULL, NULL),
			('200600087985', NULL, NULL),
			('200600087993', NULL, NULL),
			('200600088009', NULL, NULL),
			('200600088033', NULL, NULL),
			('200600088058', NULL, NULL),
			('200600088181', NULL, NULL),
			('200600088199', NULL, NULL),
			('200600088207', NULL, NULL),
			('200600088223', NULL, NULL),
			('200600088322', NULL, NULL),
			('200600088389', NULL, NULL),
			('200600088397', NULL, NULL),
			('200600088405', NULL, NULL),
			('200600088413', NULL, NULL),
			('200600088496', NULL, NULL),
			('200600088538', NULL, NULL),
			('200600088553', NULL, NULL),
			('200600088579', NULL, NULL),
			('200600088603', NULL, NULL),
			('200600088694', NULL, NULL),
			('200600088769', NULL, NULL),
			('200600088843', NULL, NULL),
			('200600088850', NULL, NULL),
			('200600088876', NULL, NULL),
			('200600088900', NULL, NULL),
			('200600088975', NULL, NULL),
			('200600089015', NULL, NULL),
			('200600089197', NULL, NULL),
			('200600089312', NULL, NULL),
			('200600089395', NULL, NULL),
			('001120973011', NULL, NULL),
			('001120979018', NULL, NULL),
			('001121007017', NULL, NULL),
			('054102740001', NULL, NULL),
			('001100221019', NULL, NULL),
			('001119619070', NULL, NULL),
			('001103479010', NULL, NULL),
			('001125343012', NULL, NULL),
			('001105889018', NULL, NULL),
			('001130228018', NULL, NULL),
			('001130263015', NULL, NULL);

	# Work out site IDs from merchant number data element entries.
	UPDATE visa_qr_temp
	SET siteId = (SELECT sp.site_id
				  FROM site_profiles sp
				  JOIN `profile` p ON sp.profile_id = p.profile_id AND p.profile_type_id = @siteProfileTypeId
				  JOIN profile_data pd ON p.profile_id = pd.profile_id AND pd.data_element_id = @merchantNoDataElementId
				  WHERE pd.datavalue = merchantNo
				  ORDER BY sp.updated_at DESC
				  LIMIT 1);
				  
	# Work out profile IDs from site IDs.
	UPDATE visa_qr_temp
	SET siteProfileId = (SELECT sp.profile_id
						 FROM site_profiles sp
						 JOIN `profile` p ON sp.profile_id = p.profile_id AND p.profile_type_id = @siteProfileTypeId
						 WHERE site_id = siteId
						 ORDER BY sp.updated_at DESC
						 LIMIT 1);

	# Log and then remove any sites which don't actually exist.
	SELECT * FROM visa_qr_temp WHERE siteId IS NULL OR siteProfileId IS NULL;
	DELETE FROM visa_qr_temp WHERE siteId IS NULL OR siteProfileId IS NULL;

	# Update the timestamp of the MPAN field so that config download will see this as new.
	UPDATE profile_data pd
	SET updated_at = CURRENT_TIMESTAMP,
		updated_by = 'system'
	WHERE pd.profile_id IN (SELECT siteProfileId FROM visa_qr_temp)
	AND data_element_id = @mpanDataElementId;

	DROP TEMPORARY TABLE IF EXISTS visa_qr_temp;
END